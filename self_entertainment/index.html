<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>单行读文本</title>
</head>

<body>
    <input type="file" id="file">
    <button id="read">Read</button>

    <pre id="output"></pre>

    <script src="jquery-3.0.0.min.js"></script>
    <script src="Reader.js"></script>
    <script>
        $(function () {
            var lr = new LineReader(); //文件块chunkSize  默认1024B,可以自己设置大小new LineReader({chunkSize: 1}) 

            $('#read').click(function () {
                var file = $('#file').get(0).files[0];
                var totalCount = 1;
                var $output = $('#output');

                lr.on('line', function (line, next) {
                    $output.text($output.text() + '\n' + totalCount + ': ' + line);

                    totalCount++;

                    /** 
                     * 模拟某种形式的异步操作 
                     */
                    setTimeout(function () {
                        next();
                    }, 100);
                });

                lr.on('error', function (err) {
                    console.log(err);
                });

                lr.on('end', function () {
                    console.log('Read complete!');
                });

                lr.read(file);
            });

        });
    </script>
</body>

</html>