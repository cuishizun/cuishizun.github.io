class zz{compressPhotoUpload(obj){let files="";let name="";let Blobs="";let ratio=obj.ratio||0.1;let maxsize=obj.maxsize||1024;if(obj.elem){files=obj.elem.files[0];name=files.name;let reader=new FileReader();reader.readAsDataURL(files);let p1=new Promise(function(resolve,reject){reader.onload=function(e){resolve(e)};reader.onerror=function(e){reject(e)}});p1.then((e)=>{let result=e.target.result;if(e.total/1024>maxsize){let p2=new Promise(function(resolve,reject){let image=new Image();image.src=result;image.onload=function(e){resolve(image)};image.onerror=function(e){reject(e)}});p2.then((e)=>{var canvas=document.querySelector("canvas");var context=canvas.getContext("2d");canvas.width=e.width/2.5;canvas.height=e.height/2.5;context.drawImage(e,0,0,e.width/ 2.5, e.height /2.5);let dataUrl=canvas.toDataURL('image/jpeg',ratio);let length=this.dataURLtoBlob(dataUrl);Blobs=dataUrl;obj.success({data:Blobs,size:length.size,name:name,dataType:'image/jpeg'})},(e)=>{console.log(e)})}else{obj.success({data:result,size:files.size,name:name,dataType:files.type})}},(e)=>{console.log(e)})}};dataURLtoBlob(dataurl){var arr=dataurl.split(','),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);while(n--){u8arr[n]=bstr.charCodeAt(n)}return new Blob([u8arr],{type:mime})}}